<div class="page-container">
	<div class="page-header">
		<div class="header-content">
			<div class="title-section">
				<h1>{{ campaign?.title }}</h1>
				<span class="badge" [class]="campaign?.activeSession ? 'badge-active' : 'badge-inactive'">
					{{ campaign?.activeSession ? 'Em Sessão' : 'Pausada' }}
				</span>
			</div>
			<div class="header-actions" *ngIf="!editMode">
				<button class="btn btn-secondary" *ngIf="isOwner" (click)="toggleEditMode()">
					Editar
				</button>
				<button class="btn btn-primary" *ngIf="!campaign?.activeSession && isOwner" (click)="startSession()">
					Iniciar Aventura
				</button>
				<button class="btn btn-warning" *ngIf="campaign?.activeSession && isOwner" (click)="endSession()">
					Encerrar Aventura
				</button>
			</div>
			<div class="header-actions" *ngIf="editMode">
				<button class="btn btn-secondary" (click)="cancelEdit()">Cancelar</button>
				<button class="btn btn-primary" (click)="saveChanges()" [disabled]="isLoading">
					{{ isLoading ? 'Salvando...' : 'Salvar' }}
				</button>
			</div>
		</div>
	</div>

	<div class="page-content" *ngIf="campaign">
		<!-- Modo Visualização -->
		<div class="view-mode" *ngIf="!editMode">
			<div class="campaign-details">
				<div class="detail-card">
					<h3>Informações da Campanha</h3>
					<div class="info-grid">
						<div class="info-item">
							<span class="label">Sistema:</span>
							<span class="value">{{ getSystemName(campaign.systemId) }}</span>
						</div>
						<div class="info-item">
							<span class="label">Mestre:</span>
							<span class="value">{{ getMasterName(campaign.masterId) }}</span>
						</div>
						<div class="info-item">
							<span class="label">Jogadores:</span>
							<span class="value">{{ campaign.playerIds.length || 0 }} participantes</span>
						</div>
						<div class="info-item">
							<span class="label">Status:</span>
							<span class="value">{{ campaign.activeSession ? 'Aventura em andamento' : 'Aguardando próxima sessão' }}</span>
						</div>
					</div>
				</div>

				<div class="detail-card" *ngIf="campaign.description">
					<h3>História da Campanha</h3>
					<p class="description">{{ campaign.description }}</p>
				</div>

				<div class="detail-card" *ngIf="campaign.characters?.length">
					<h3>Personagens da Aventura</h3>
					<div class="characters-list">
						<div class="character-item" *ngFor="let character of campaign.characters">
							<!-- TODO: Mostrar informações dos personagens -->
							<p>Personagem ID: {{ character.characterId }}</p>
						</div>
					</div>
				</div>

				<div class="danger-zone" *ngIf="isOwner">
					<h3>Zona de Perigo</h3>
					<button class="btn btn-danger" (click)="deleteCampaign()">
						Encerrar Campanha Permanentemente
					</button>
				</div>
			</div>
		</div>

		<!-- Modo Edição -->
		<div class="edit-mode" *ngIf="editMode">
			<form [formGroup]="editForm" (ngSubmit)="saveChanges()">
				<div class="form-group">
					<label for="title">Nome da Campanha*</label>
					<input id="title" type="text" formControlName="title" class="form-control"
						[class.error]="editForm.get('title')?.invalid && editForm.get('title')?.touched">
					<div class="error-message" *ngIf="editForm.get('title')?.invalid && editForm.get('title')?.touched">
						Nome é obrigatório
					</div>
				</div>

				<div class="form-group">
					<label for="systemId">Sistema de RPG*</label>
					<select id="systemId" formControlName="systemId" class="form-control"
						[class.error]="editForm.get('systemId')?.invalid && editForm.get('systemId')?.touched">
						<option value="">Selecione um sistema</option>
						<option *ngFor="let system of systems" [value]="system.id">
							{{ system.name }}
						</option>
					</select>
					<div class="error-message"
						*ngIf="editForm.get('systemId')?.invalid && editForm.get('systemId')?.touched">
						Sistema é obrigatório
					</div>
				</div>

				<div class="form-group">
					<label for="description">História da Campanha</label>
					<textarea id="description" formControlName="description" class="form-control" rows="6"
						placeholder="Descreva a história, ambientação e objetivos da campanha...">
					</textarea>
				</div>
			</form>
		</div>
	</div>

	<div class="loading-state" *ngIf="!campaign && !isLoading">
		<p>Campanha não encontrada</p>
		<button class="btn btn-primary" routerLink="/campaigns">Voltar às Campanhas</button>
	</div>
</div>
