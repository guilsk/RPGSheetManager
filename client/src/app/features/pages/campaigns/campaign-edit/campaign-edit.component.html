<div class="campaign-edit">
	<div class="campaign-edit__header">
		<div class="campaign-edit__header-actions">
			<button class="campaign-edit__back-button" (click)="goBack()">
				‚Üê Voltar √†s Campanhas
			</button>
		</div>

		<h1 class="campaign-edit__header-title">{{ isEditing ? 'Editar Campanha' : 'Nova Campanha' }}</h1>
		<p class="campaign-edit__header-description">{{ isEditing ? 'Modifique as informa√ß√µes da sua campanha' : 'Crie uma nova aventura √©pica para seus jogadores' }}</p>

		<!-- Status da Campanha (apenas para edi√ß√£o) -->
		<div *ngIf="isEditing && currentCampaign" class="campaign-edit__status">
			<span class="campaign-edit__status-badge" [class]="currentCampaign.activeSession ? 'campaign-edit__status-badge--active' : 'campaign-edit__status-badge--inactive'">
				{{ currentCampaign.activeSession ? 'üü¢ Em Sess√£o' : '‚è∏Ô∏è Pausada' }}
			</span>
		</div>
	</div>

	<div class="campaign-edit__form-container">
		<form [formGroup]="campaignForm" (ngSubmit)="saveCampaign()">

			<div class="campaign-edit__form-group">
				<label class="campaign-edit__form-group-label" for="title">Nome da Campanha*</label>
				<input
					id="title"
					type="text"
					formControlName="title"
					class="campaign-edit__form-group-control"
					placeholder="Ex: A Ascens√£o dos Drag√µes"
					[class.campaign-edit__form-group-control--error]="campaignForm.get('title')?.invalid && campaignForm.get('title')?.touched">
				<div class="campaign-edit__form-group-error" *ngIf="campaignForm.get('title')?.invalid && campaignForm.get('title')?.touched">
					Nome √© obrigat√≥rio
				</div>
			</div>

			<div class="campaign-edit__form-group">
				<label class="campaign-edit__form-group-label" for="systemId">Sistema de RPG*</label>
				<select
					id="systemId"
					formControlName="systemId"
					class="campaign-edit__form-group-control"
					[class.campaign-edit__form-group-control--error]="campaignForm.get('systemId')?.invalid && campaignForm.get('systemId')?.touched">
					<option value="" disabled hidden>
						{{ loadingSystems ? 'Carregando sistemas...' : 'Selecione um sistema de RPG' }}
					</option>
					<option *ngFor="let system of systems" [value]="system.id">
						{{ system.name }}
					</option>
				</select>
				<div class="campaign-edit__form-group-error" *ngIf="campaignForm.get('systemId')?.invalid && campaignForm.get('systemId')?.touched">
					Sistema √© obrigat√≥rio
				</div>
				<div class="campaign-edit__form-group-help" *ngIf="systems.length === 0 && !loadingSystems">
					<small>Nenhum sistema encontrado. Voc√™ pode ser o primeiro a cadastrar um sistema na aba 'Sistemas'</small>
				</div>
			</div>

			<div class="campaign-edit__form-group">
				<label class="campaign-edit__form-group-label" for="description">Descri√ß√£o da Campanha</label>
				<textarea
					id="description"
					formControlName="description"
					class="campaign-edit__form-group-control campaign-edit__form-group-control--textarea"
					rows="4"
					placeholder="Descreva a hist√≥ria, ambienta√ß√£o e objetivos da campanha...">
				</textarea>
			</div>

			<div class="campaign-edit__actions">
				<!-- Bot√£o de ativar/desativar sess√£o (apenas para edi√ß√£o) -->
				<button
					*ngIf="isEditing && currentCampaign"
					type="button"
					class="campaign-edit__button"
					[class]="currentCampaign.activeSession ? 'campaign-edit__button--warning' : 'campaign-edit__button--success'"
					(click)="toggleSession()"
					[disabled]="isLoading">
					{{ currentCampaign.activeSession ? '‚è∏Ô∏è Pausar Sess√£o' : '‚ñ∂Ô∏è Ativar Sess√£o' }}
				</button>

				<button type="button" class="campaign-edit__button campaign-edit__button--secondary" (click)="cancel()">
					Cancelar
				</button>

				<button
					type="submit"
					class="campaign-edit__button campaign-edit__button--primary"
					[disabled]="campaignForm.invalid || isLoading">
					{{ isLoading ? 'Salvando...' : (isEditing ? 'Atualizar' : 'Criar Campanha') }}
				</button>
			</div>
		</form>
	</div>
</div>
